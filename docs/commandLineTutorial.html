

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>writing your own V2G-Sim scripts &mdash; V2G-Sim 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="V2G-Sim 0.1 documentation" href="index.html"/>
        <link rel="next" title="writing your own charging function" href="chargingFunc.html"/>
        <link rel="prev" title="packages and modules structure" href="package_and_module_structure.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> V2G-Sim
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="V2Gconcept.html">what is Vehicle 2 Grid (V2G)</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_structure.html">data structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_and_module_structure.html">packages and modules structure</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">writing your own V2G-Sim scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="chargingFunc.html">writing your own charging function</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">core module</a></li>
<li class="toctree-l1"><a class="reference internal" href="itinerary.html">itinerary package</a></li>
<li class="toctree-l1"><a class="reference internal" href="charging.html">charging package</a></li>
<li class="toctree-l1"><a class="reference internal" href="driving.html">driving package</a></li>
<li class="toctree-l1"><a class="reference internal" href="result.html">result package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">V2G-Sim</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>writing your own V2G-Sim scripts</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/commandLineTutorial.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-your-own-v2g-sim-scripts">
<h1>writing your own V2G-Sim scripts<a class="headerlink" href="#writing-your-own-v2g-sim-scripts" title="Permalink to this headline">Â¶</a></h1>
<p>This section will be dissecting a basic project template, and further ideas to solve complex problems.
Note that <em>launching a simulation by following the basic template won&#8217;t require of you to be Python expert.</em> In fact the main reason we have chosen to use Python is for its readability and simplicity.</p>
<p>To launch any script of your own, simply go in the right folder and type:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="n">mybasic_example</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Note: you might need to use &#8220;kivy&#8221; instead of &#8220;python&#8221; if you are a Macintosh user.</p>
<dl class="docutils">
<dt>The following self explanatory snippet demonstrate how to:</dt>
<dd><ul class="first last simple">
<li>Import necessary modules</li>
<li>Load vehicles</li>
<li>Check their integrity</li>
<li>Launch a simulation</li>
<li>Plot results</li>
</ul>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s2">&quot;path/to/v2g_sim&quot;</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">core</span>
<span class="kn">import</span> <span class="nn">itinerary.load</span>
<span class="kn">import</span> <span class="nn">result.visualization.matp</span>

<span class="c1"># Initialize locations and vehicles from excel file</span>
<span class="n">excelFilename</span> <span class="o">=</span> <span class="s1">&#39;path/to/your/excel/file&#39;</span>
<span class="n">vehicleList</span><span class="p">,</span> <span class="n">locationList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">excel</span><span class="p">(</span><span class="n">excelFilename</span><span class="p">)</span>

<span class="c1"># Supress vehicles that could not be initialized correctly</span>
<span class="n">vehicleList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">remove_vehicle_with_empty_itinerary</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">)</span>

<span class="c1"># Launch a simulation</span>
<span class="n">core</span><span class="o">.</span><span class="n">runV2GSim</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">nbIteration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Plot the total power demand</span>
<span class="n">result</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">matp</span><span class="o">.</span><span class="n">total_EV_power_demand</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">)</span>
</pre></div>
</div>
<p>Once you have run this example, it&#8217;s time to go further and experiment with the influence of different parameters.
The graph below introduces certain types of modifications you may want to add on top of the basic template.
Remember that for any given number of vehicles or locations you can change any attribute, this includes the function used to track SOC when driving or charging.</p>
<img alt="_images/V2G-SimPossibility.png" src="_images/V2G-SimPossibility.png" />
<dl class="docutils">
<dt>Understand your input data</dt>
<dd><p class="first">With V2G-Sim we made it possible to examine what kind of itineraries is in your input data.
To do so:</p>
<blockquote>
<div><ul class="simple">
<li>find all the combinations of activities (&#8220;home&#8221;, &#8220;work&#8221;, ...)</li>
<li>merge the combination to form bigger group</li>
<li>get statistical data on activity duration and distance driven</li>
<li>create more vehicles based on statistics</li>
</ul>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">itineraryBinList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">itineraryBin</span><span class="o">.</span><span class="n">find_all_itinerary_combination</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">)</span>
<span class="n">itineraryBinList</span> <span class="o">=</span>  <span class="n">itinerary</span><span class="o">.</span><span class="n">itineraryBin</span><span class="o">.</span><span class="n">merge_itinerary_combination</span><span class="p">(</span><span class="n">itineraryBinList</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Home&#39;</span><span class="p">,</span> <span class="s1">&#39;Work&#39;</span><span class="p">])</span>
<span class="n">itineraryBinList</span> <span class="o">=</span>  <span class="n">itinerary</span><span class="o">.</span><span class="n">itineraryBin</span><span class="o">.</span><span class="n">distance_and_duration_per_activity</span><span class="p">(</span><span class="n">itineraryBinList</span><span class="p">)</span>
<span class="n">vehicleList</span><span class="p">,</span> <span class="n">locationList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">create_vehicles</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">itineraryBinList</span><span class="p">,</span> <span class="n">vehicleNumber</span><span class="p">)</span>
</pre></div>
</div>
<p>You could also decide to remove part of your input data to keep consistent trips. For instance, this function only keeps trips starting and ending at home.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="n">itineraryBinList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">itineraryBin</span><span class="o">.</span><span class="n">extract_home_to_home_itinerary</span><span class="p">(</span><span class="n">itineraryBinList</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Initialize a grid</dt>
<dd>Work in progress.</dd>
<dt>Update vehicles</dt>
<dd><p class="first">You might want to change the proportion of a specific car model in your data, or modify the initial SOC of some vehicles. The following example shows how you could increase the battery capacity of vehicles that have stranded in the past simulation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">vehicle</span> <span class="ow">in</span> <span class="n">vehicleList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">strandingLog</span><span class="p">:</span>
                <span class="n">vehicle</span><span class="o">.</span><span class="n">carModel</span><span class="o">.</span><span class="n">batteryCap</span> <span class="o">+=</span> <span class="mi">1000</span> <span class="c1">#(Wh)</span>
</pre></div>
</div>
<p class="last">Someone could run simulations until no more vehicles are stranding, and then look at how many people are satisfied by different battery capacity.</p>
</dd>
<dt>Update locations</dt>
<dd><p class="first">Locations are linked to a charging station, by changing the power rate and the number of chargers available you can find a right balance between people&#8217;s need and your grid opportunities. Charging station will often need to be controlled in a intelligent manner so that electrical vehicles benefit the grid. V2G-Sim offers you the possibility to test your own charging strategy. The following example demonstrate how to change maximum power rate and number of available chargers for all work locations.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">locationList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">location</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;Work&quot;</span><span class="p">:</span>
                <span class="n">location</span><span class="o">.</span><span class="n">chargingInfra</span><span class="o">.</span><span class="n">availability</span> <span class="o">-=</span> <span class="mi">100</span> <span class="c1">#(number of stations)</span>
                <span class="n">location</span><span class="o">.</span><span class="n">chargingInfra</span><span class="o">.</span><span class="n">powerRateMax</span> <span class="o">+=</span> <span class="mi">1000</span> <span class="c1">#(W)</span>
</pre></div>
</div>
</dd>
<dt>Solving strategy</dt>
<dd>Work in progress, for now the only core algorithm is &#8220;core.runV2GSim()&#8221; (see core module)</dd>
<dt>Retrieve results</dt>
<dd><p class="first">The result package contains modules in order to get result at the end of a simulation, it also contains a sub-package &#8220;visualization&#8221; that will help users plot their results. The visualization package contains 2 modules, one of them help gathering data to plot graph through D3.js, the other is simply using Matplotlib.</p>
<p>In order to use the module for Matplotlib refer to the API documentation to find the appropriate function.</p>
<p>If you need an overview of your data and result, you can use the d3.py module. Below is an example to launch it:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="n">folder</span> <span class="o">=</span> <span class="s1">&#39;/Path/to/V2G-Sim/v2g_sim/result/visualization/web-content&#39;</span>
<span class="n">result</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">d3</span><span class="o">.</span><span class="n">visualization</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">itineraryBinList</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chargingFunc.html" class="btn btn-neutral float-right" title="writing your own charging function" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="package_and_module_structure.html" class="btn btn-neutral" title="packages and modules structure" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Lawrence Berkeley National Laboratory.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>